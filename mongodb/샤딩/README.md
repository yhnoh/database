### 샤딩

- mongos:
- config server: 
- sharding server:


rs.status();
sh.status();


### 데이터 추적
- 도큐먼트를 청크로 나눔, 하나의 청크는 항상 하나의 샤드에 위치
  - 샤드 키 범위 내에 있는 도큐먼드를 청크로 나눔
- 청크의 사이즈가 커지면 몽고DB는 자동으로 두개의 청크로 나눈다.
  - 하나의 샤드에 데이터가 몰리는 것을 방지
- 청크 정보는 config.chunk 정보에 저장
- 샤드 프라이머리 mongod는 청크에 얼마나 많은 데이터가 삽입되는지 추적하고, 특정 임계치에 이르면 청크를 나눠야할지 확인한다. 청크가 나뉘어야 한다면 전역 청크 구성 값을 요청, 이후 청크 분할을 수행하고 구성서버에서 메타데이터를 갱신한다.
- mongod가 분할을 시도할 때 구성서버중 하나가 작동하지 않으면 mongod는 메타데이터를 갱신할 수 없다. 모든 구성서버가 살아 있어야 분할 가능, 만약 구성 서버 장애가 있다면 mongod가 반복적으로 청크 분할을 시도하고 실패하는 과정을 일으키는 분할 소동(split storm)을 일으킨다,

#### 밸런서
- 데이터 이동을 책임진다. 각 샤드의 청크 수를 모니터링하고 구성 서버 복제 셋의 프라이머리의 백그라운드 프로세스, 샤드의 청크 수가 특정 마이그레이션 임계치를 이를때만 활성화

#### 콜레이션
- 문자열 비교를 위한 언어별 규칙 지정

### 스트림 변경
- 스트림 변경을 사용하면 애플리케이션 데이터베이스 내 데이터의 실시간 변경 사항을 추적할 수 있다.
- 컬렉션, 컬렉션 집합 데이터베이스 또는 전체 배포상의 모든 데이터 변경에 대한 구독 매커니즘을 제공한다.
- 이를 통해 애플리케이션은 특정 변경 사항을 필터링하거나 수신된 변경 알람을 변환할 수 있다.
- 