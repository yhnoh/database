


### 인덱스 효율성

- 인덱스를 스캔하는 단계에 처리하는 조건절은 엑세스 조건과 필터 조건으로 나뉜다.
- 인덱스 엑세스 조건은 인덱스 스캔 범위를 결정한다.
  - 인덱스 수직적 탐색을 통해서 인덱스 시작접을 결정하고, 어디서 멈출지를 결정하는데 영향을 미친다.
- 인덱스 필터조건은 테이블로 엑세스할지를 결정한는 조건절이다.
  - 커버링 인덱스와 같이 실제로 테이블에 접근하지 않는 경우들도 있다.
- 테이블 엑세스 단계에서 처리되는 조건절은 모두 필터 조건이다.
  - 테이블 필터 조건은 쿼리 수행 다음 단계로 전달하거나 최종 결과집합에 포함할지를 결정한다.

###  1. 인덱스 선행 컬럼이 등치(=) 조건이 아닐때 생기는 비효율
- 인덱스 스캔에서 조건절에 모두 등치 조건으로 활용되거나, 선행 컬럼은 등치 조건이면서 후행 컬럼은 범위 조건절로 활용될 때 인덱스 스캔이 효율적으로 활용된다.
```sql
select * from table where a = 1
select * from table where a = 1 and b between 1 and 3
select * from table where a = 1 and b = 1 and c between 1 and 3
```
> 여기서 인덱스 스캔이 효율적이라는 의미는 스캔을 하는 동안 필터링 되는 레코드가 없다는 의미이다.
- 만약 인덱스 선행컬럼이 범위 조건이고, 후행컬럼이 등치조건일 경우 인덱스 스캔의 비효율이 발생한다.
```sql
select * from table where a between 1 and 3 and b = 1
select * from table where a = 1 and a between 1 and 3 and c = 1
```
- 불필요한 인덱스까지 스캔하게 되면서 인덱스 필터 조건을 걸게된다.

### 2. NOT-EQUAL 조건으로 사용된 경우 생기는 비효율 ("<>", "NOT IN", "NOT BETWEEN", "IS NOT NULL")

### 3. 범위검색 조건을 남용할 때 생기는 비효율

#### 2.1. BETWEEN
#### 2.2. IN
#### 2.3. LIKE

### 4. 페이징 쿼리 사용시 발생하는 비효율


- BETWEEN 절과 IN 절은 범위 검색을 위하여 많이들 활용하고 있지만 인덱스 스캔방식에는 차이가 존재한다.
- 먼저 BETWEEN의 스캔방식을 확인해보자.
- BETWEEN의 경우 인덱스 수직적 탐색이후 수평적 탐색을 진행하며, 추가적인 조건으로 인해서 인덱스가 필터링 될 수 있다.
  - 인덱스가 필터링될 경우, 해당 인덱스를 사용하기 위해서
- 간단하게 해결 가능하기 때문에 BETWEEN
- 

> https://jojoldu.tistory.com/529
> https://hoing.io/archives/24493
> https://jojoldu.tistory.com/565

### 범위검색 조건을 남용할 때 생기는 비효율
- SQL문의 많은 작성을 회피하기 위해서 하나의 범위검색을 통해서 다양한 상황을 대처하려고 하는 경우 범위 검색을 남발하는 경우가 있다.
- 범위 검색 조건을 남용하면 인덱스 스캔 비효율이 생기게 되며 성능에 영향을 미칠 수 있다.
  - 만약 대량 테이블을 넓은 범위로 검색하게 되는 경우 성능이 안좋아진다.

### IN 조건 활용

### BETWEEN/LIKE 조건 활용



> Real MySql 8.0 개발자와 DBA를 위한 MySQL 실전 가이드, 백은비,이성욱, P247-253 <br/> 
> 친절한 SQL 튜닝, 조시형, P173-229